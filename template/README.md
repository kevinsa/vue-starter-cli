# MyCitrix VueJS Starter UI Application

> This is a VueJS template UI application that can be used to bootstrap MyCitrix single page UI application developement.  

## Application Structure
**src/components/Login.vue** - Authentication component that exchages MyCitrixHash cookie for authentication token

**src/components/Home.vue** - Application initial view displayed after authentication success

**src/components/About.vue** - Sample application component

**src/router/index.js** - Route configuration for application routes and components for each route.  Routes can be declared as protected or not protected

**src/store/store.js** - Application Vuex store.  The application store is available to all components and is used to maintain application state such as the currently logged in user

**src/mainjs** - Vue application configuration and application component mounting

**src/App.vue** - Application component - contains wrapper markup for component rendering

## Environment Value Configuration

Application configuration is stored in environment specific files in the config directory.  In code, the values are retrieved using:

```javascript
var myUrl = ${process.env.BASE_URL}
```

The process.env object is mapped to the corresponding environment configuration object based on the NODE_ENV environment value.

The following environments are supported: development, testing and production

The build process replaces the above code with the actual value in the environment configuration file.  For example, when building for preprod the following:

```javascript
var myUrl = ${process.env.BASE_URL}
```

would become:

```javascript
var myUrl = "https://preprodmc.citrix.com"
```

when the build command "npm run build" on a machine having the OS environment variable NODE_ENV=testing


## Install Dependencies
The application requires third party and custom dependencies.  You need to have read-only access to Artifactory in order to install all the dependencies.  Every user on the domain should have readonly access to Artifactory.  The URL to the Artifactory respository is located in the .npmrc file

```bash
#install dependencies
npm install
```

## Launching the Application

Authentication is cookie based so in order for this to work the domains of the authentication cookie, token end point and application must be accessed on the same domain.

1. Create a host file entry on your development machine so that it's accessible on citrix.com

``` bash
127.0.0.1	mydev.citrix.com
```

2. Make sure you update the cookie string used in the Login.vue component to be a valid cookie.  You can get a valid value by logging into the CMS (contenttest.citrix.com) and grabbing the value of the MyCitrixHash cookie in Chrome developer tools.

``` javascript
const cookieString = 'MyCitrixHash=DomainName=contentest.citrix.com&ModifiedOn=03%2f02%2f2018&ID1=MTQyNzMzNjU%3d&ID2=119C45BC77BF25E71D798A7494FF8C910436B977&SiteLanguage=English;domain=.citrix.com'
```

3.  Launch the development server, this starts the code and opens a browser window to localhost:8080

``` bash
npm run dev
```

4.  Reload the on the domain specified in the host file entry from step 1.  In this case, http://mydev.citrix.com:8080

The code produced by the **npm run dev** command is generated by webpack based on the **build/dev-server.js** definition and environment values are injected into the code from **config/dev.env.js**.  The resulting code is non-minified and can be debugged using Chrome developer tools.

## Environment Builds
The build definitions are based on webpack and are defined in the **build** and **config** directories.

### Production Builds
The command to generate a production build produces minified code and with production specific environment values injected into the code.  The build configuration is based on webpack and is defined in the **build/webpack.prod.conf.js** file.  This file uses the environment configuration values from **config/prod.env.js**

``` javascript
set NODE_ENV=production

npm run build
```

### Staging (PreProd) Builds
The command to generate a staging build produces non-minified code and with staging specific environment values injected into the code.  The build configuration is based on webpack and is defined in the **build/webpack.test.conf.js** file.  This file uses the environment configuration values from **config/test.env.js**

``` javascript
set NODE_ENV=testing

npm run build
```


## More Commands

``` bash
# install dependencies
npm install

# serve with hot reload at localhost:8080
npm run dev

# build for production with minification
npm run build

# build for production and view the bundle analyzer report
npm run build --report

# run unit tests
npm run unit

# run e2e tests
npm run e2e

# run all tests
npm test
```

For a detailed explanation on how things work, check out the [guide](http://vuejs-templates.github.io/webpack/) and [docs for vue-loader](http://vuejs.github.io/vue-loader).